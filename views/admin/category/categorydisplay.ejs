<%- include('../../header.ejs') %>

<div class="container-fluid mt-5 pt-4">
  <div class="row">

    <!-- LEFT SIDEBAR -->
    <div class="col-md-3">
      <%- include('../../partials/sidebar') %>
    </div>

    <!-- RIGHT CONTENT -->
    <div class="col-md-9">

      <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Categories</h5>

          <!-- ADD CATEGORY BUTTON (Bootstrap 5) -->
          <button
            type="button"
            class="btn btn-primary"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal"
          >
            + Add Category
          </button>
        </div>

        <div class="card-body">

          <table class="table table-bordered table-hover align-middle">
            <thead class="table-light">
              <tr>
                <th width="60">#</th>
                <th>Category Title</th>
                <th width="150">Action</th>
              </tr>
            </thead>

            <tbody>
              <% if (cd.length === 0) { %>
                <tr>
                  <td colspan="3" class="text-center text-muted">
                    No categories found
                  </td>
                </tr>
              <% } %>

              <% let i = 1; %>
              <% cd.forEach((c) => { %>
                <tr>
                  <td><%= i++ %></td>
                  <td><strong><%= c.categoryname %></strong></td>
                  <td>
                    <a
                      href="/admin/categoryview/<%= c._id %>"
                      class="text-info me-2"
                      title="View"
                    >
                      <i class="fa-solid fa-eye"></i>
                    </a>

                    <a
                      href="/admin/categoryedit/<%= c._id %>"
                      class="text-success me-2"
                      title="Edit"
                    >
                      <i class="fa-solid fa-pen-to-square"></i>
                    </a>

                    <a
                      href="/admin/categorydelete/<%= c._id %>"
                      onclick="return confirm('Are you sure you want to disable this category?')"
                      class="text-danger"
                      title="Delete"
                    >
                      <i class="fa-solid fa-trash"></i>
                    </a>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>

        </div>
      </div>

    </div>
  </div>
</div>

<!-- ADD CATEGORY MODAL (Bootstrap 5) -->
<div class="modal fade" id="exampleModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Add Category</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <form
        method="post"
        action="/admin/categoryinsert"
        enctype="multipart/form-data"
      >
        <div class="modal-body">

          <div class="mb-3">
            <label class="form-label">Category Title *</label>
            <input
              type="text"
              name="categoryname"
              class="form-control"
              required
            >
          </div>

          <div class="mb-3">
            <label class="form-label">Upload Image</label>
            <input
              type="file"
              name="image"
              class="form-control"
              accept="image/*"
            >
          </div>

        </div>

        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary">
            Save
          </button>
        </div>
      </form>

    </div>
  </div>
</div>

<%- include('../../footer.ejs') %>
